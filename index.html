<!DOCTYPE html>
<html>
<head>
    
</head>

<body>

    <button type="button" id="myBtn" onclick="AEPSDeviceCapture()">Capture</button>
    <br>
    <br>
    <label id="lblPidData"></label>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
    <script>

        function AEPSDeviceCapture() {
            var port;
            var urlStr = '';
            urlStr = 'http://127.0.0.1:11100/rd/capture';
            getJSONCapture(urlStr,
                function (err, data) {
                    if (err == null) {
                        
                        $(document).ready(function () {
                            $('#lblPidData').text(data);
                        });

                    } else {


                        swal('Error', 'Device Not Ready Please Check', 'error');

                    }
                }
            );
        }
        var getJSONCapture = function (url, callback) {
            var xhr = new XMLHttpRequest();
            xhr.open('CAPTURE', url, true);
            xhr.responseType = 'text'; //json
            var InputXml = "<PidOptions ver=\"1.0\" env=\"P\"><Opts fCount=\"1\" fType=\"2\" iCount=\"0\" iType=\"0\" pCount =\"0\" pType =\"\" format=\"0\" pidVer=\"2.0\" timeout=\"20000\" otp=\"\" wadh=\"\" posh =\"UNKNOWN\"   /> <Demo></Demo> <CustOpts> <Param name =\"\" value=\"\" /> </CustOpts> </PidOptions>";

            xhr.onload = function () {
                var status = xhr.response;
                if (status.includes('errInfo=\"Success\"') || status.includes('errCode="0"')) {
                    callback(null, xhr.response);
                } else {
                    callback("Capture Fail", null);
                }
            };
            xhr.send(InputXml);
        };
    </script>

</body>

</html>
